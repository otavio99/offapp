<script src="https://cdn.auth0.com/js/auth0-spa-js/1.20/auth0-spa-js.production.js"></script>

<script type="text/javascript">
  const checkenv = () => {
    if (window.location.origin.includes("localhost")) {
      return "dev";
    } else {
      return "prod";
    }
  };

  const getredirecturl = (env) => {
    if (env === 'prod') {
      return window.location.origin + "/{{site.basepathurl}}/" + "callback/";
    } else {
      return window.location.origin + "/callback/";
    }
  }

  const domain = "{{site.domain | json}}";
  const clientId = "{{site.clientid | json}}";
  const auth0 = new Auth0Client({
    domain: domain,
    client_id: clientId,
    redirect_uri: getredirecturl(checkenv())
  });

  const run = async () => {
    try {
      await auth0.getTokenSilently({detailedResponse: true});
    } catch (error) {
      window.location.href = "/login";
    }
  }
  run();
</script>
