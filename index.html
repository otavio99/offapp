---
layout: page
---
{% raw %}

<div id="app">
  <h1>Olá! {{user.given_name}}</h1>
  <h2>Cadastrar filmes</h2>
  <hr>
  <form @submit="checkForm">
    <div class="form-group">
      <label for="exampleInputEmail1">Nome</label>
      <input type="text" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="" v-model="name">
    </div>
    <div class="form-group">
      <label for="exampleInputPassword1">Avaliação (0-10)</label>
      <input type="number" class="form-control" id="exampleInputPassword1" placeholder="" v-model="rate">
    </div>
    <button type="submit" class="btn btn-primary">Salvar</button>
  </form>
</div>
{% endraw %}

<script src="https://cdn.auth0.com/js/auth0-spa-js/1.20/auth0-spa-js.production.js"></script>
<script type="module">
  import { createApp } from 'vue'

  createApp({
    data() {
      return {
        message: 'Hello Vue!',
        count: 0,
        name: '',
        rate: null,
        user: JSON.parse(localStorage.getItem('user'))
      }
    },
    methods: {
      increment,
      checkForm
    }
  }).mount('#app')
</script>

<script>
  function increment() {
    this.count++
  }
</script>

<script>
  function checkForm (e) {
    console.log(this.name, this.rate)
    e.preventDefault();
  }
</script>

<script type="text/javascript">
  const checkenv = () => {
    if (window.location.origin.includes("localhost")) {
      return "dev";
    } else {
      return "prod";
    }
  };

  const getredirecturl = (env) => {
    if (env === 'prod') {
      return window.location.origin + "/{{site.basepathurl}}/" + "callback/";
    } else {
      return window.location.origin + "/callback/";
    }
  }

  const domain = "{{site.domain | json}}"
  const clientId = "{{site.clientid | json}}"
  const auth0 = new Auth0Client({
    domain: domain,
    client_id: clientId,
    redirect_uri: getredirecturl(checkenv())
  });


  const getFetch = async () => {
    const tok = await auth0.getTokenSilently({detailedResponse: true})
    const res = await fetch("http://127.0.0.1:8787/", {
      headers: {
        "Authorization": `${JSON.stringify(tok.id_token)}`
      }
    })
    console.log(await res.json())
    console.log(tok)
  }

  getFetch()
</script>


<!-- <script type="text/javascript">
  fetch('https://another-hello.onss.workers.dev/')
  .then(response => {
    return response.text()
  }).then(data => {
    console.log(data)
  })
</script> -->
