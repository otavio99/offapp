---
layout: page
---
<style media="screen">
.hidden {
  display: none;
}

label {
  margin-bottom: 10px;
  display: block;
}
</style>

<h2>Logar</h2>
<p>Bem vindo</p>
<button id="btn-login" disabled="true" onclick="login()">Log in</button>
<button id="btn-logout" disabled="true" onclick="logout()">Log out</button>



<script src="https://cdn.auth0.com/js/auth0-spa-js/1.20/auth0-spa-js.production.js"></script>
<script>
  let auth0 = null;
  const domain = "{{site.domain | json}}"
  const clientId = "{{site.clientid | json}}"

  const configureClient = async () => {
    auth0 = await createAuth0Client({
      domain: domain,
      client_id: clientId
    });
  };

  const updateUI = async () => {
    const isAuthenticated = await auth0.isAuthenticated();

    document.getElementById("btn-logout").disabled = !isAuthenticated;
    document.getElementById("btn-login").disabled = isAuthenticated;
  };

  const checkenv = () => {
    if (window.location.origin.includes("localhost")) {
      return "dev";
    } else {
      return "prod";
    }
  };

  const getredirecturl = (env) => {
    if (env === 'prod') {
      return window.location.origin + "/{{basepathurl}}/" + "/callback/";
    } else {
      return window.location.origin + "/callback/";
    }
  }

  const login = async () => {
    await auth0.loginWithRedirect({
      redirect_uri: getredirecturl()
    });
  };

  const logout = () => {
    auth0.logout({
      returnTo: window.location.origin
    });
  };
  window.onload = async () => {
    console.log(checkenv())
    await configureClient();
    updateUI();

    const isAuthenticated = await auth0.isAuthenticated();

    if (isAuthenticated) {
      const usuario = JSON.stringify(
        await auth0.getUser()
      );
      console.log(usuario)
      return;
    }
  }

</script>
