---
layout: page
permalink: /list
---
{% raw %}
  <div id="app">
    <h2>Lista de filmes</h2>
    <hr>
    <ul class="" v-for="movie in movies">
      <li class="">
        {{ movie.name }} - {{movie.rate}}/10 |
        <a :data-id=movie.id href="#" @click="view">Ver</a> |
        <a :data-id=movie.id href="#" @click="deleteMovie">Excluir</a> |
      </li>
    </ul>
  </div>
{% endraw %}


<script type="module">
  import { createApp } from 'vue';

  createApp({
    data() {
      return {
        movies: []
      }
    },
    methods: {
      deleteMovie (elm) {
        elm.preventDefault();
        this.movies = [...this.movies.filter(movie => movie.id !== elm.target.dataset.id)]
        localStorage.setItem('movies', JSON.stringify(this.movies));
      },
      view (elm) {
        elm.preventDefault();
        window.location = '/view?id=' + elm.target.dataset.id;
      }
    },
    created () {
      this.movies.push(...JSON.parse(localStorage.getItem('movies')))
    }
  }).mount('#app')
</script>

{% include auth/auth_check.html %}
